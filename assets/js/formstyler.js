!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e($||require("jquery")):e(jQuery)}(function(e){"use strict";function t(t,s){this.element=t,this.options=e.extend({},i,s);var l=this.options.locale;void 0!==this.options.locales[l]&&e.extend(this.options,this.options.locales[l]),this.init()}function s(t){if(!e(t.target).parents().hasClass("jq-selectbox")&&"OPTION"!=t.target.nodeName&&e("div.jq-selectbox.opened").length){var s=e("div.jq-selectbox.opened"),i=e("div.jq-selectbox__search input",s),o=e("div.jq-selectbox__dropdown",s);s.find("select").data("_"+l).options.onSelectClosed.call(s),i.length&&i.val("").keyup(),o.hide().find("li.sel").addClass("selected"),s.removeClass("focused opened dropup dropdown")}}var l="styler",i={idSuffix:"-styler",filePlaceholder:"File not chosen",fileBrowse:"View...",fileNumber:"Files chosen: %s",selectPlaceholder:"Choose...",selectSearch:!1,selectSearchLimit:10,selectSearchNotFound:"No matches found",selectSearchPlaceholder:"Search...",selectVisibleOptions:0,selectSmartPositioning:!0,locale:"ru",locales:{en:{filePlaceholder:"No file selected",fileBrowse:"Browse...",fileNumber:"Selected files: %s",selectPlaceholder:"Select...",selectSearchNotFound:"No matches found",selectSearchPlaceholder:"Search..."}},onSelectOpened:function(){},onSelectClosed:function(){},onFormStyled:function(){}};t.prototype={init:function(){function t(){void 0!==l.attr("id")&&""!==l.attr("id")&&(this.id=l.attr("id")+i.idSuffix),this.title=l.attr("title"),this.classes=l.attr("class"),this.data=l.data()}var l=e(this.element),i=this.options;if(l.is(":checkbox")){var o=function(){var s=new t,i=e('<div class="jq-checkbox"><div class="jq-checkbox__div"></div></div>').attr({id:s.id,title:s.title}).addClass(s.classes).data(s.data);l.after(i).prependTo(i),l.is(":checked")&&i.addClass("checked"),l.is(":disabled")&&i.addClass("disabled"),i.click(function(e){e.preventDefault(),l.triggerHandler("click"),i.is(".disabled")||(l.is(":checked")?(l.prop("checked",!1),i.removeClass("checked")):(l.prop("checked",!0),i.addClass("checked")),l.focus().change())}),l.closest("label").add('label[for="'+l.attr("id")+'"]').on("click.styler",function(t){e(t.target).is("a")||e(t.target).closest(i).length||(i.triggerHandler("click"),t.preventDefault())}),l.on("change.styler",function(){l.is(":checked")?i.addClass("checked"):i.removeClass("checked")}).on("keydown.styler",function(e){32==e.which&&i.click()}).on("focus.styler",function(){i.is(".disabled")||i.addClass("focused")}).on("blur.styler",function(){i.removeClass("focused")})};o(),l.on("refresh",function(){l.closest("label").add('label[for="'+l.attr("id")+'"]').off(".styler"),l.off(".styler").parent().before(l).remove(),o()})}else if(l.is(":radio")){var a=function(){var s=new t,i=e('<div class="jq-radio"><div class="jq-radio__div"></div></div>').attr({id:s.id,title:s.title}).addClass(s.classes).data(s.data);l.after(i).prependTo(i),l.is(":checked")&&i.addClass("checked"),l.is(":disabled")&&i.addClass("disabled"),e.fn.commonParents=function(){var t=this;return t.first().parents().filter(function(){return e(this).find(t).length===t.length})},e.fn.commonParent=function(){return e(this).commonParents().first()},i.click(function(t){if(t.preventDefault(),l.triggerHandler("click"),!i.is(".disabled")){var s=e('input[name="'+l.attr("name")+'"]');s.commonParent().find(s).prop("checked",!1).parent().removeClass("checked"),l.prop("checked",!0).parent().addClass("checked"),l.focus().change()}}),l.closest("label").add('label[for="'+l.attr("id")+'"]').on("click.styler",function(t){e(t.target).is("a")||e(t.target).closest(i).length||(i.triggerHandler("click"),t.preventDefault())}),l.on("change.styler",function(){l.parent().addClass("checked")}).on("focus.styler",function(){i.is(".disabled")||i.addClass("focused")}).on("blur.styler",function(){i.removeClass("focused")})};a(),l.on("refresh",function(){l.closest("label").add('label[for="'+l.attr("id")+'"]').off(".styler"),l.off(".styler").parent().before(l).remove(),a()})}else if(l.is(":file")){var d=function(){var s=new t,o=l.data("placeholder");void 0===o&&(o=i.filePlaceholder);var a=l.data("browse");void 0!==a&&""!==a||(a=i.fileBrowse);var d=e('<div class="jq-file"><div class="jq-file__name">'+o+'</div><div class="jq-file__browse">'+a+"</div></div>").attr({id:s.id,title:s.title}).addClass(s.classes).data(s.data);l.after(d).appendTo(d),l.is(":disabled")&&d.addClass("disabled");var r=l.val(),c=e("div.jq-file__name",d);r&&c.text(r.replace(/.+[\\\/]/,"")),l.on("change.styler",function(){var e=l.val();if(l.is("[multiple]")){e="";var t=l[0].files.length;if(t>0){var s=l.data("number");void 0===s&&(s=i.fileNumber),e=s=s.replace("%s",t)}}c.text(e.replace(/.+[\\\/]/,"")),""===e?(c.text(o),d.removeClass("changed")):d.addClass("changed")}).on("focus.styler",function(){d.addClass("focused")}).on("blur.styler",function(){d.removeClass("focused")}).on("click.styler",function(){d.removeClass("focused")})};d(),l.on("refresh",function(){l.off(".styler").parent().before(l).remove(),d()})}else if(l.is('input[type="number"]')){var r=function(){var s=new t,i=e('<div class="jq-number"><div class="jq-number__spin minus"></div><div class="jq-number__spin plus"></div></div>').attr({id:s.id,title:s.title}).addClass(s.classes).data(s.data);l.after(i).prependTo(i).wrap('<div class="jq-number__field"></div>'),l.is(":disabled")&&i.addClass("disabled");var o,a,d,r=null,c=null;void 0!==l.attr("min")&&(o=l.attr("min")),void 0!==l.attr("max")&&(a=l.attr("max")),d=void 0!==l.attr("step")&&e.isNumeric(l.attr("step"))?Number(l.attr("step")):Number(1);var n=function(t){var s,i=l.val();e.isNumeric(i)||(i=0,l.val("0")),t.is(".minus")?s=Number(i)-d:t.is(".plus")&&(s=Number(i)+d);var r=(d.toString().split(".")[1]||[]).length;if(r>0){for(var c="1";c.length<=r;)c+="0";s=Math.round(s*c)/c}e.isNumeric(o)&&e.isNumeric(a)?s>=o&&s<=a&&l.val(s):e.isNumeric(o)&&!e.isNumeric(a)?s>=o&&l.val(s):!e.isNumeric(o)&&e.isNumeric(a)?s<=a&&l.val(s):l.val(s)};i.is(".disabled")||(i.on("mousedown","div.jq-number__spin",function(){var t=e(this);n(t),r=setTimeout(function(){c=setInterval(function(){n(t)},40)},350)}).on("mouseup mouseout","div.jq-number__spin",function(){clearTimeout(r),clearInterval(c)}).on("mouseup","div.jq-number__spin",function(){l.change().trigger("input")}),l.on("focus.styler",function(){i.addClass("focused")}).on("blur.styler",function(){i.removeClass("focused")}))};r(),l.on("refresh",function(){l.off(".styler").closest(".jq-number").before(l).remove(),r()})}else if(l.is("select")){var c=function(){function o(e){var t=e.prop("scrollHeight")-e.outerHeight(),s=null,l=null;e.off("mousewheel DOMMouseScroll").on("mousewheel DOMMouseScroll",function(i){s=i.originalEvent.detail<0||i.originalEvent.wheelDelta>0?1:-1,((l=e.scrollTop())>=t&&s<0||l<=0&&s>0)&&(i.stopPropagation(),i.preventDefault())})}function a(){for(var e=0;e<p.length;e++){var t=p.eq(e),s="",l="",o="",a="",d="",r="",c="",n="",f="";t.prop("selected")&&(l="selected sel"),t.is(":disabled")&&(l="disabled"),t.is(":selected:disabled")&&(l="selected sel disabled"),void 0!==t.attr("id")&&""!==t.attr("id")&&(a=' id="'+t.attr("id")+i.idSuffix+'"'),void 0!==t.attr("title")&&""!==p.attr("title")&&(d=' title="'+t.attr("title")+'"'),void 0!==t.attr("class")&&(c=" "+t.attr("class"),f=' data-jqfs-class="'+t.attr("class")+'"');var h=t.data();for(var u in h)""!==h[u]&&(r+=" data-"+u+'="'+h[u]+'"');l+c!==""&&(o=' class="'+l+c+'"'),s="<li"+f+r+o+d+a+">"+t.html()+"</li>",t.parent().is("optgroup")&&(void 0!==t.parent().attr("class")&&(n=" "+t.parent().attr("class")),s="<li"+f+r+' class="'+l+c+" option"+n+'"'+d+a+">"+t.html()+"</li>",t.is(":first-child")&&(s='<li class="optgroup'+n+'">'+t.parent().attr("label")+"</li>"+s)),v+=s}}var d,r,c,n,f,h,u,p=e("option",l),v="";l.is("[multiple]")?(d=new t,r=e('<div class="jq-select-multiple jqselect"></div>').attr({id:d.id,title:d.title}).addClass(d.classes).data(d.data),l.after(r),a(),r.append("<ul>"+v+"</ul>"),c=e("ul",r),n=e("li",r),f=l.attr("size"),h=c.outerHeight(),u=n.outerHeight(),void 0!==f&&f>0?c.css({height:u*f}):c.css({height:4*u}),h>r.height()&&(c.css("overflowY","scroll"),o(c),n.filter(".selected").length&&c.scrollTop(c.scrollTop()+n.filter(".selected").position().top)),l.prependTo(r),l.is(":disabled")?(r.addClass("disabled"),p.each(function(){e(this).is(":selected")&&n.eq(e(this).index()).addClass("selected")})):(n.filter(":not(.disabled):not(.optgroup)").click(function(t){l.focus();var s=e(this);if(t.ctrlKey||t.metaKey||s.addClass("selected"),t.shiftKey||s.addClass("first"),t.ctrlKey||t.metaKey||t.shiftKey||s.siblings().removeClass("selected first"),(t.ctrlKey||t.metaKey)&&(s.is(".selected")?s.removeClass("selected first"):s.addClass("selected first"),s.siblings().removeClass("first")),t.shiftKey){var i=!1,o=!1;s.siblings().removeClass("selected").siblings(".first").addClass("selected"),s.prevAll().each(function(){e(this).is(".first")&&(i=!0)}),s.nextAll().each(function(){e(this).is(".first")&&(o=!0)}),i&&s.prevAll().each(function(){if(e(this).is(".selected"))return!1;e(this).not(".disabled, .optgroup").addClass("selected")}),o&&s.nextAll().each(function(){if(e(this).is(".selected"))return!1;e(this).not(".disabled, .optgroup").addClass("selected")}),1==n.filter(".selected").length&&s.addClass("first")}p.prop("selected",!1),n.filter(".selected").each(function(){var t=e(this),s=t.index();t.is(".option")&&(s-=t.prevAll(".optgroup").length),p.eq(s).prop("selected",!0)}),l.change()}),p.each(function(t){e(this).data("optionIndex",t)}),l.on("change.styler",function(){n.removeClass("selected");var t=[];p.filter(":selected").each(function(){t.push(e(this).data("optionIndex"))}),n.not(".optgroup").filter(function(s){return e.inArray(s,t)>-1}).addClass("selected")}).on("focus.styler",function(){r.addClass("focused")}).on("blur.styler",function(){r.removeClass("focused")}),h>r.height()&&l.on("keydown.styler",function(e){38!=e.which&&37!=e.which&&33!=e.which||c.scrollTop(c.scrollTop()+n.filter(".selected").position().top-u),40!=e.which&&39!=e.which&&34!=e.which||c.scrollTop(c.scrollTop()+n.filter(".selected:last").position().top-c.innerHeight()+2*u)}))):!function(){var d=new t,r="",c=l.data("placeholder"),n=l.data("search"),f=l.data("search-limit"),h=l.data("search-not-found"),u=l.data("search-placeholder"),m=l.data("smart-positioning");void 0===c&&(c=i.selectPlaceholder),void 0!==n&&""!==n||(n=i.selectSearch),void 0!==f&&""!==f||(f=i.selectSearchLimit),void 0!==h&&""!==h||(h=i.selectSearchNotFound),void 0===u&&(u=i.selectSearchPlaceholder),void 0!==m&&""!==m||(m=i.selectSmartPositioning);var g=e('<div class="jq-selectbox jqselect"><div class="jq-selectbox__select"><div class="jq-selectbox__select-text"></div><div class="jq-selectbox__trigger"><div class="jq-selectbox__trigger-arrow"></div></div></div></div>').attr({id:d.id,title:d.title}).addClass(d.classes).data(d.data);l.after(g).prependTo(g);var b=g.css("z-index");b=b>0?b:1;var C=e("div.jq-selectbox__select",g),x=e("div.jq-selectbox__select-text",g),y=p.filter(":selected");a(),n&&(r='<div class="jq-selectbox__search"><input type="search" autocomplete="off" placeholder="'+u+'"></div><div class="jq-selectbox__not-found">'+h+"</div>");var w=e('<div class="jq-selectbox__dropdown">'+r+"<ul>"+v+"</ul></div>");g.append(w);var q=e("ul",w),j=e("li",w),k=e("input",w),S=e("div.jq-selectbox__not-found",w).hide();j.length<f&&k.parent().hide(),""===p.first().text()&&p.first().is(":selected")&&!1!==c?x.text(c).addClass("placeholder"):x.text(y.text());var _=0,T=0;if(j.css({display:"inline-block"}),j.each(function(){var t=e(this);t.innerWidth()>_&&(_=t.innerWidth(),T=t.width())}),j.css({display:""}),x.is(".placeholder")&&x.width()>_)x.width(x.width());else{var N=g.clone().appendTo("body").width("auto"),H=N.outerWidth();N.remove(),H==g.outerWidth()&&x.width(T)}_>g.width()&&w.width(_),""===p.first().text()&&""!==l.data("placeholder")&&j.first().hide();var P=g.outerHeight(!0),D=k.parent().outerHeight(!0)||0,A=q.css("max-height"),K=j.filter(".selected");if(K.length<1&&j.first().addClass("selected sel"),void 0===j.data("li-height")){var O=j.outerHeight();!1!==c&&(O=j.eq(1).outerHeight()),j.data("li-height",O)}var F=w.css("top");if("auto"==w.css("left")&&w.css({left:0}),"auto"==w.css("top")&&(w.css({top:P}),F=P),w.hide(),K.length&&(p.first().text()!=y.text()&&g.addClass("changed"),g.data("jqfs-class",K.data("jqfs-class")),g.addClass(K.data("jqfs-class"))),l.is(":disabled"))return g.addClass("disabled"),!1;C.click(function(){e("div.jq-selectbox").filter(".opened").length&&i.onSelectClosed.call(e("div.jq-selectbox").filter(".opened")),l.focus();var t=e(window),s=j.data("li-height"),a=g.offset().top,d=t.height()-P-(a-t.scrollTop()),r=l.data("visible-options");void 0!==r&&""!==r||(r=i.selectVisibleOptions);var c=5*s,n=s*r;r>0&&r<6&&(c=n),0===r&&(n="auto");var f,h=function(){w.height("auto").css({bottom:"auto",top:F});var e=function(){q.css("max-height",Math.floor((d-20-D)/s)*s)};e(),q.css("max-height",n),"none"!=A&&q.css("max-height",A),d<w.outerHeight()+20&&e()};!0===m||1===m?d>c+D+20?(h(),g.removeClass("dropup").addClass("dropdown")):(w.height("auto").css({top:"auto",bottom:"auto"}),(f=function(){q.css("max-height","20rem")})(),q.css("max-height",n),"none"!=A&&q.css("max-height",A),a-t.scrollTop()-20<w.outerHeight()+20&&f(),g.removeClass("dropdown").addClass("dropup")):!1===m||0===m?d>c+D+20&&(h(),g.removeClass("dropup").addClass("dropdown")):(w.height("auto").css({bottom:"auto",top:F}),q.css("max-height",n),"none"!=A&&q.css("max-height",A)),g.offset().left+w.outerWidth()>t.width()&&w.css({left:"auto",right:0}),e("div.jqselect").css({zIndex:b-1}).removeClass("opened"),g.css({zIndex:b}),w.is(":hidden")?(e("div.jq-selectbox__dropdown:visible").hide(),w.show(),g.addClass("opened focused"),i.onSelectOpened.call(g)):(w.hide(),g.removeClass("opened dropup dropdown"),e("div.jq-selectbox").filter(".opened").length&&i.onSelectClosed.call(g)),k.length&&(k.val("").keyup(),S.hide(),k.keyup(function(){var t=e(this).val();j.each(function(){e(this).html().match(RegExp(".*?"+t+".*?","i"))?e(this).show():e(this).hide()}),""===p.first().text()&&""!==l.data("placeholder")&&j.first().hide(),j.filter(":visible").length<1?S.show():S.hide()})),j.filter(".selected").length&&(""===l.val()?q.scrollTop(0):(q.innerHeight()/s%2!=0&&(s/=2),q.scrollTop(q.scrollTop()+j.filter(".selected").position().top-q.innerHeight()/2+s))),o(q)}),j.hover(function(){e(this).siblings().removeClass("selected")});var I=j.filter(".selected").text();j.filter(":not(.disabled):not(.optgroup)").click(function(){l.focus();var t=e(this),s=t.text();if(!t.is(".selected")){var o=t.index();o-=t.prevAll(".optgroup").length,t.addClass("selected sel").siblings().removeClass("selected sel"),p.prop("selected",!1).eq(o).prop("selected",!0),I=s,x.text(s),g.data("jqfs-class")&&g.removeClass(g.data("jqfs-class")),g.data("jqfs-class",t.data("jqfs-class")),g.addClass(t.data("jqfs-class")),l.change()}w.hide(),g.removeClass("opened dropup dropdown"),i.onSelectClosed.call(g)}),w.mouseout(function(){e("li.sel",w).addClass("selected")}),l.on("change.styler",function(){x.text(p.filter(":selected").text()).removeClass("placeholder"),j.removeClass("selected sel").not(".optgroup").eq(l[0].selectedIndex).addClass("selected sel"),p.first().text()!=j.filter(".selected").text()?g.addClass("changed"):g.removeClass("changed")}).on("focus.styler",function(){g.addClass("focused"),e("div.jqselect").not(".focused").removeClass("opened dropup dropdown").find("div.jq-selectbox__dropdown").hide()}).on("blur.styler",function(){g.removeClass("focused")}).on("keydown.styler keyup.styler",function(e){var t=j.data("li-height");""===l.val()?x.text(c).addClass("placeholder"):x.text(p.filter(":selected").text()),j.removeClass("selected sel").not(".optgroup").eq(l[0].selectedIndex).addClass("selected sel"),38!=e.which&&37!=e.which&&33!=e.which&&36!=e.which||(""===l.val()?q.scrollTop(0):q.scrollTop(q.scrollTop()+j.filter(".selected").position().top)),40!=e.which&&39!=e.which&&34!=e.which&&35!=e.which||q.scrollTop(q.scrollTop()+j.filter(".selected").position().top-q.innerHeight()+t),13==e.which&&(e.preventDefault(),w.hide(),g.removeClass("opened dropup dropdown"),i.onSelectClosed.call(g))}).on("keydown.styler",function(e){32==e.which&&(e.preventDefault(),C.click())}),s.registered||(e(document).on("click",s),s.registered=!0)}()};c(),l.on("refresh",function(){l.off(".styler").parent().before(l).remove(),c()})}else l.is(":reset")&&l.on("click",function(){setTimeout(function(){l.closest("form").find("input, select").trigger("refresh")},1)})},destroy:function(){var t=e(this.element);t.is(":checkbox")||t.is(":radio")?(t.removeData("_"+l).off(".styler refresh").removeAttr("style").parent().before(t).remove(),t.closest("label").add('label[for="'+t.attr("id")+'"]').off(".styler")):t.is('input[type="number"]')?t.removeData("_"+l).off(".styler refresh").closest(".jq-number").before(t).remove():(t.is(":file")||t.is("select"))&&t.removeData("_"+l).off(".styler refresh").removeAttr("style").parent().before(t).remove()}},e.fn[l]=function(s){var i,o=arguments;return void 0===s||"object"==typeof s?(this.each(function(){e.data(this,"_"+l)||e.data(this,"_"+l,new t(this,s))}).promise().done(function(){var t=e(this[0]).data("_"+l);t&&t.options.onFormStyled.call()}),this):"string"==typeof s&&"_"!==s[0]&&"init"!==s?(this.each(function(){var a=e.data(this,"_"+l);a instanceof t&&"function"==typeof a[s]&&(i=a[s].apply(a,Array.prototype.slice.call(o,1)))}),void 0!==i?i:this):void 0},s.registered=!1});